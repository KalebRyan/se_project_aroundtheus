!function(){"use strict";class e{constructor(e,t,s){let{name:r,link:n}=e;this._name=r,this._link=n,this._cardSelector=t,this._handleImageClick=s}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteIcon()})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}_handleDeleteIcon(){this._cardElement.remove(),this._cardElement=null}getCard(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent=" ",this._errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}class r{constructor(e){let{modalSelector:t}=e;this._modalElement=document.querySelector(t)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()})),this._modalElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()}))}}class n extends r{constructor(e,t){let{modalSelector:s}=e;super({modalSelector:s}),this._handleFormSubmit=t,this._form=this._modalElement.querySelector(".modal__form")}_getInputValues(){return this._inputList=this._modalElement.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}document.querySelector("#profile__edit-modal");const i=document.querySelector("#profile__edit-button"),o=document.forms["profile-form"],a=(document.querySelectorAll(".modal__close-button"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(".modal__input_type_name")),l=document.querySelector(".modal__input_type_description"),d=document.querySelector(".cards__list"),c=(document.querySelector("#card__template").content.firstElementChild,document.querySelector("#card__add-modal"),document.querySelector("#profile__add-button")),_=document.forms["card-form"],h=(_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_link"),document.querySelector("#preview__image-modal"));h.querySelector(".modal__preview-image"),h.querySelector(".modal__image-caption");const m=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}setUserInfo(e){let{name:t,about:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleResponse)}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._handleResponse)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse)}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"24d24150-f342-4b21-ba37-43c96c87f158","Content-Type":"application/json"}});Promise.all([m.getUserInfo(),m.getInitialCards()]).then((t=>{let[r,n]=t;S.setUserInfo(r);const i=new s({items:n,renderer:t=>{const s=new e(t,"#card__template",v);i.addItem(s.getCard())}},".cards__list");i.renderItems()})).catch((e=>{console.error(e)}));const u=new class extends r{constructor(e){let{modalSelector:t}=e;super({modalSelector:t}),this._image=this._modalElement.querySelector(".modal__preview-image"),this._name=this._modalElement.querySelector(".modal__image-caption")}open(e){let{name:t,link:s}=e;this._image.src=s,this._image.alt=t,this._name.textContent=t,super.open()}}({modalSelector:"#preview__image-modal"});u.setEventListeners();const p=new n({modalSelector:"#profile__edit-modal"},(function(e){S.setUserInfo(e),p.close()}));p.setEventListeners();const E=new n({modalSelector:"#card__add-modal"},(function(t){m.addCard(t).then((t=>{const s=new e(t,"#card__template",v);d.prepend(s.getCard())})).catch((e=>{console.error(e)})),E.close()}));E.setEventListeners();const S=new class{constructor(e){let{nameSelector:t,descriptionSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._description=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._name.textContent=t,this._description.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__avatar"});function v(e){u.open(e)}i.addEventListener("click",(()=>{p.open(),function(){const e=S.getUserInfo();a.value=e.name,l.value=e.description}(),f[o.getAttribute("name")].resetValidation()})),c.addEventListener("click",(()=>{f[_.getAttribute("name")].resetValidation(),E.open()}));const f={};var y;y={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(y.formSelector)).forEach((e=>{const s=new t(y,e),r=e.getAttribute("name");f[r]=s,s.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUIsSUFHcEV3QyxFQUFjL0YsaUJBQWlCLFNBQVMsS0FDdEMySixFQUFlMUQsRUFBUzJELGFBQWEsU0FBU3JHLGtCQUM5QzBGLEVBQWExRSxNQUFNLElBSXJCLE1BQU1vRixFQUFpQixDQUFDLEVBRUV4SSxRRHpKSixDQUNwQjBJLGFBQWMsZUFDZHRJLGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksd0JDb0pLK0gsTUFBTUMsS0FBS3JKLFNBQVN1QyxpQkFBaUI5QixFQUFPMEksZUFDcEQzRyxTQUFTOUIsSUFDaEIsTUFBTTRJLEVBQVksSUFBSTlJLEVBQWNDLEVBQVFDLEdBQ3RDNkksRUFBVzdJLEVBQUt3SSxhQUFhLFFBRW5DRCxFQUFlTSxHQUFZRCxFQUMzQkEsRUFBVTVHLGtCQUFrQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUljb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUljb24oKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCIgXCI7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9LCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCIvLyBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxyXG4vLyAgIH0sXHJcbi8vIF07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19lZGl0LW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XHJcbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8vIENhcmQgVGVtcGxhdGVcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX190ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuLy8gQWRkIENhcmQgTW9kYWxcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZF9fYWRkLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJjYXJkLWZvcm1cIl07XHJcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfdGl0bGVcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgY2FyZExpbmtJbnB1dCA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfbGlua1wiKTtcclxuXHJcbi8vIFByZXZpZXcgSW1hZ2UgTW9kYWxcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcmV2aWV3X19pbWFnZS1tb2RhbFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUNhcHRpb24gPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCJcclxuKTtcclxuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGluaXRpYWxDYXJkcyxcclxuICBjb25maWcsXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZUZvcm0sXHJcbiAgcHJvZmlsZVRpdGxlLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBjYXJkTGlzdCxcclxuICBjYXJkVGVtcGxhdGUsXHJcbiAgYWRkQ2FyZEJ1dHRvbixcclxuICBjYXJkRm9ybSxcclxuICBjYXJkVGl0bGVJbnB1dCxcclxuICBjYXJkTGlua0lucHV0LFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8vIEFQSSBDYWxsc1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIyNGQyNDE1MC1mMzQyLTRiMjEtYmEzNy00M2M5NmM4N2YxNThcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmREYXRhXSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkRGF0YSxcclxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmRfX3RlbXBsYXRlXCIsIGhhbmRsZUltYWdlQ2xpY2spO1xyXG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkLmdldENhcmQoKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICAgKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy8gYXBpXHJcbi8vICAgLmdldFVzZXJJbmZvKClcclxuLy8gICAudGhlbigocmVzKSA9PiB7XHJcbi8vICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4vLyAgIH0pXHJcbi8vICAgLmNhdGNoKChlcnIpID0+IHtcclxuLy8gICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuLy8gICB9KTtcclxuXHJcbi8vIGFwaVxyXG4vLyAgIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4vLyAgIC50aGVuKChyZXMpID0+IHtcclxuLy8gICAgIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbi8vICAgICAgIHtcclxuLy8gICAgICAgICBpdGVtczogcmVzLFxyXG4vLyAgICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuLy8gICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbi8vICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuLy8gICAgICAgICB9LFxyXG4vLyAgICAgICB9LFxyXG4vLyAgICAgICBcIi5jYXJkc19fbGlzdFwiXHJcbi8vICAgICApO1xyXG4vLyAgICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMocmVzKTtcclxuLy8gICB9KVxyXG4vLyAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbi8vICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbi8vICAgfSk7XHJcblxyXG4vLyBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4vLyAgIHtcclxuLy8gICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbi8vICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbi8vICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbi8vICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4vLyAgICAgfSxcclxuLy8gICB9LFxyXG4vLyAgIFwiLmNhcmRzX19saXN0XCJcclxuLy8gKTtcclxuXHJcbi8vIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcblxyXG5jb25zdCBtb2RhbFdpdGhJbWFnZSA9IG5ldyBNb2RhbFdpdGhJbWFnZSh7XHJcbiAgbW9kYWxTZWxlY3RvcjogXCIjcHJldmlld19faW1hZ2UtbW9kYWxcIixcclxufSk7XHJcbm1vZGFsV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0TW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICB7XHJcbiAgICBtb2RhbFNlbGVjdG9yOiBcIiNwcm9maWxlX19lZGl0LW1vZGFsXCIsXHJcbiAgfSxcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxyXG4pO1xyXG5cclxuZWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICB7XHJcbiAgICBtb2RhbFNlbGVjdG9yOiBcIiNjYXJkX19hZGQtbW9kYWxcIixcclxuICB9LFxyXG4gIGhhbmRsZUNhcmRGb3JtU3VibWl0XHJcbik7XHJcbm5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufSk7XHJcblxyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBpbmZvLmRlc2NyaXB0aW9uO1xyXG59XHJcblxyXG4vLyBIYW5kbGVyc1xyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChkYXRhKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbiAgZWRpdE1vZGFsLmNsb3NlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGRhdGEpIHtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChyZXMsIFwiI2NhcmRfX3RlbXBsYXRlXCIsIGhhbmRsZUltYWdlQ2xpY2spO1xyXG4gICAgICBjYXJkTGlzdC5wcmVwZW5kKGNhcmQuZ2V0Q2FyZCgpKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxuICAvLyBjb25zdCBuYW1lID0gZGF0YS50aXRsZTtcclxuICAvLyBjb25zdCBsaW5rID0gZGF0YS5saW5rO1xyXG4gIC8vIHJlbmRlckNhcmQoeyBuYW1lLCBsaW5rIH0pO1xyXG4gIG5ld0NhcmRNb2RhbC5jbG9zZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XHJcbiAgbW9kYWxXaXRoSW1hZ2Uub3BlbihjYXJkRGF0YSk7XHJcbn1cclxuXHJcbi8vIENhcmQgUmVuZGVyaW5nXHJcbi8vIGZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuLy8gICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmRfX3RlbXBsYXRlXCIsIGhhbmRsZUltYWdlQ2xpY2spO1xyXG4vLyAgIHJldHVybiBjYXJkLmdldENhcmQoKTtcclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4vLyAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbi8vICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbi8vIH1cclxuXHJcbi8vIEV2ZW50IExpc3RlbmVyc1xyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW2NhcmRGb3JtLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIG5ld0NhcmRNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gRm9ybSBWYWxpZGF0aW9uXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtKSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm0pO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtLmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcblxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEltYWdlIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xyXG4gICAgdGhpcy5fbmFtZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlSWNvbiIsIl9jYXJkSW1hZ2UiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJnZXRDYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGUiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbGVtZW50cyIsImV2ZXJ5IiwiX2Rpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsIk1vZGFsIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiTW9kYWxXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRm9ybSIsImZvcm1zIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImNhcmRMaXN0IiwiYWRkQ2FyZEJ1dHRvbiIsImZpcnN0RWxlbWVudENoaWxkIiwiY2FyZEZvcm0iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsIl9yZWYzIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwicmVtb3ZlTGlrZSIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmREYXRhIiwidXNlckluZm8iLCJjYXJkU2VjdGlvbiIsImNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIm1vZGFsV2l0aEltYWdlIiwiX2ltYWdlIiwiZWRpdE1vZGFsIiwiZGF0YSIsIm5ld0NhcmRNb2RhbCIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9kZXNjcmlwdGlvbiIsIl9hdmF0YXIiLCJkZXNjcmlwdGlvbiIsInNldFVzZXJBdmF0YXIiLCJpbmZvIiwiZmlsbFByb2ZpbGVGb3JtIiwiZm9ybVZhbGlkYXRvcnMiLCJnZXRBdHRyaWJ1dGUiLCJmb3JtU2VsZWN0b3IiLCJBcnJheSIsImZyb20iLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSJdLCJzb3VyY2VSb290IjoiIn0=